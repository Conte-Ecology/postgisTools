missingArc <- which(allStats$arc == -9999)
missingPSQL <- which(is.na(allStats$psql))
both <- which(allStats$arc == -9999 & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
metrics
head(allStats)
range(allStats$psql)
range(allStats$psql, na.rm = T)
layerNames[j]
range(allStats$arc, na.rm = T)
arcStats$arc_count[which(arcStats$arc_count = -9999)]
arcStats$arc_count[which(arcStats$arc_count == -9999)]
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc_count[which(arcStats$arc_count == -9999)]
arcStats$arc[which(arcStats$arc == -9999)]
arcStats$arc[which(arcStats$arc == -9999)] <- NA
rm(list=ls())
library(foreign)
library(dplyr)
# Prep work
layerNames <- c("ann_tmin_c", "dep_so4_2011")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(allStats$arc == -9999)
missingPSQL <- which(is.na(allStats$psql))
both <- which(allStats$arc == -9999 & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
rm(list=ls())
library(foreign)
library(dplyr)
# Prep work
layerNames <- c("ann_tmin_c", "dep_so4_2011")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
metrics
range(allStats$arc)
range(allStats$arc, na.rm= T)
min(allStats$psql)
rm(list=ls())
library(foreign)
library(dplyr)
# Prep work
layerNames <- c("ann_tmin_c", "dep_so4_2011")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
metrics
rm(list=ls())
library(foreign)
library(dplyr)
# Prep work
layerNames <- c("forest", "elevation", "ann_tmin_c", "dep_so4_2011")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
metrics
layerNames <- c("elevation")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
metrics
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
#rm(arcStats)
}
dim(point)
dim(areal)
length(missingPSQL)
length(both)
length(missingArc)
allStats
allStats[which(is.na(allStats$psql)),]
length(which(is.na(psqlStats)))
dim(psqlStats)
layerNames <- c("forest")
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
rm(arcStats)
psqlTables <- "C:/KPONEIL/postgisTools/zonalStatistics/tables"
arcTables <- "C:/KPONEIL/SHEDS/basinCharacteristics/zonalStatistics/versions/NHDHRDV2/gisTables"
metrics <- as.data.frame(matrix(nrow = length(layerNames), ncol = 5))
names(metrics) <- c("Layer_Name", "RMSE", "Point_RMSE", "Areal_RMSE", "Catchment_Loss_Count")
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
rm(arcStats)
}
length(which(is.na(psqlStats$mean)))
length(which(is.na(psqlStats$psql)))
length(which(is.na(arcStats$arc)))
for (j in seq_along(layerNames)){
# PSQL Stats
# ----------
psqlStats <- read.csv(file.path(psqlTables, paste0("stats_", layerNames[j], ".csv")))
names(psqlStats) <- c("FEATUREID", "psql_count", "psql")
# Arc Stats
# ---------
regions <- c("01", "02", "03", "04", "05", "06")
for (i in seq_along(regions)){
stats <- read.dbf(paste0(arcTables, "/Catchments", regions[i], "/", layerNames[j], ".dbf"))[,c("FEATUREID", "COUNT", "MEAN")]
if(!exists("arcStats")){
arcStats <- stats
} else {
arcStats <- rbind(arcStats, stats)
}
}
names(arcStats) <- c("FEATUREID", "arc_count", "arc")
arcStats$arc[which(arcStats$arc == -9999)] <- NA
# Calculate Stats
# ---------------
allStats <- left_join(psqlStats, arcStats, by = "FEATUREID")
# Missing values
missingArc <- which(is.na(allStats$arc))
missingPSQL <- which(is.na(allStats$psql))
both <- which(is.na(allStats$arc) & is.na(allStats$psql))
# Stat assignment method (average vs point sample)
point <- allStats[which(is.na(allStats$psql_count)),]
areal <- allStats[which(!is.na(allStats$psql_count)),]
# Layer name
metrics$Layer_Name[j] <- layerNames[j]
# Min/max values
metrics$Arc_Min_Value[j]  <- min(allStats$arc,  na.rm = T)
metrics$Arc_Max_Value[j]  <- max(allStats$arc,  na.rm = T)
metrics$PSQL_Min_Value[j] <- min(allStats$psql, na.rm = T)
metrics$PSQL_Max_Value[j] <- max(allStats$psql, na.rm = T)
# RMSE
metrics$RMSE[j] <- sqrt( mean( (allStats$arc-allStats$psql)^2 , na.rm = TRUE ) )
# Extra catchments missing PSQL
metrics$Catchment_Loss_Count[j] <- length(missingPSQL) - length(both)
# RMSE
metrics$Point_RMSE[j] <- sqrt( mean( (point$arc-point$psql)^2 , na.rm = TRUE ) )
metrics$Areal_RMSE[j] <- sqrt( mean( (areal$arc-areal$psql)^2 , na.rm = TRUE ) )
# Remove variables
#rm(arcStats)
}
length(which(is.na(arcStats$arc)))
length(which(is.na(psqlStats$psql)))
metrics
elev <- read.csv("C:/KPONEIL/postgisTools/zonalStatistics/tables/stats_elevation.csv")
head(elev)
elev$mean[which(is.na(elev$mean))]
elev$mean[which(is.na(elev$mean))] <- -9999.99
write.dbf(elev, file = "C:/KPONEIL/postgisTools/zonalStatistics/tables/stats_elevation.dbf")
